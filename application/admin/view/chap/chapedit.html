{layout name="public:layout" /}
<h4 class="text-center text-danger">编辑章节信息</h4>

{volist name="chapInfo" id="chap"}
<form class="form-horizontal" method="post" id="chap{$chap.id}">

    <input type="hidden" name="id" value="{$chap.id}">

    <div class="form-group btn-success">
        <label class="col-sm-2 control-label">章节详情:</label>
        <div class="col-sm-10">
            <div style="height: 34px; padding: 6px 12px;">ID:{$chap.id}&nbsp;&nbsp;&nbsp;&nbsp;{$chap.cat_id|getCatName}</div>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label">章节标题:</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" name="title" value="{$chap.title}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">排序:</label>
        <div class="col-sm-2">
            <input type="number" class="form-control" name="sort" value="{$chap.sort}">
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label">视频链接:</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" name="tburl" value="{$chap.tburl}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">简介:</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" name="content" value="{$chap.content}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">注意事项:</label>
        <div class="col-sm-10">
            <input type="text" class="form-control" name="attention" value="{$chap.attention}">
        </div>
    </div>


    <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
            <button type="submit" class="btn btn-info col-sm-2" id="{$chap.id}">保存</button>
            <div style="height: 34px; padding: 6px 12px;text-indent: 2em;color:red;" id="res{$chap.id}"></div>
        </div>
    </div>
    <hr>
</form>
{/volist}

<script>
    $(".btn").on('click',function () {
        var $id = this.id;
        $.ajax({
            type:'post',
            url:"{:url('chap/save')}",
            data: $('#chap'+$id).serialize(),
            dataType:'json',
            success:function (data) {
                $("#"+$id).css('color','green');
                $("#res"+$id).text(data.message);
            }
        });
        return false;
    })
</script>